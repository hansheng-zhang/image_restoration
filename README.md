# Image Enhancement Project Structure

- `low_light/`  
  Low-light image enhancement  
  *Independent implementation by Hansheng Zhang*

- `image_derain/`  
  Image deraining

- `image_dehaze/`  
  Image dehazing

# Low-Light Image Enhancement (Contributor: Hansheng Zhang)

This repository implements a framework for low-light image enhancement, comparing CLAHE and Retinex. It includes tools for processing images and analyzing performance metrics.

## Requirements

To run the code, you need Python installed along with the following libraries:

```bash
pip install numpy opencv-python pandas matplotlib seaborn pyyaml tqdm
```

## Data Setup

### 1. LOL Dataset
You can download the LOL (Low-Light) dataset from Kaggle:
- **Download Link**: [LOL Dataset on Kaggle](https://www.kaggle.com/datasets/soumikrakshit/lol-dataset)

After downloading, organize the data in the `data/` directory. For example:
- `data/raw/lol_low`: Low-light images
- `data/raw/lol_high`: High-light (Ground Truth) images

### 2. iPhone Photos
A set of low-light photos taken with an iPhone will be uploaded to this repository.
- Place these images in `data/raw/iphone` (or verify their location in the repository).

## Configuration

The project is configured via `config.yaml`. You can modify this file to change input/output directories and algorithm parameters. All **relative paths** in `config.yaml` are resolved relative to the location of the `config.yaml` file.

**Key Configuration Options:**

- **`data`**:
  - `input_dir`: Directory containing input low-light images (e.g., `"data/raw/iphone"`).
  - `gt_dir`: (Optional) Directory containing ground truth images for metric calculation (e.g., `"data/raw/lol_high"`).
  - `output_dir`: Directory where enhanced images and metrics will be saved.

- **`algorithms`**: List of algorithms to run (e.g., `['clahe', 'retinex']`).

- **`analysis`**:
  - `metrics_file`: Path to the CSV file generated by `main.py` (e.g., `"data/results/iphone/metrics.csv"`).
  - `output_dir`: Directory to save analysis plots and summaries.

## How to Run

### 1. Run Image Enhancement
To process images using the configured algorithms, please go to the directory **`low_light/`** and run:

```bash
python main.py
```

This script will:
- Read images from `input_dir`.
- Apply selected algorithms.
- Save enhanced images to `output_dir`.
- specific metrics (PSNR, SSIM, etc. if GT is available) and runtime will be saved to a `metrics.csv` file in the `output_dir`.

### 2. Analyze Results
To generate plots and summary statistics from the metrics:

1. Ensure the `metrics_file` path in `config.yaml` under the `analysis` section points to the `metrics.csv` generated in the previous step.
2. Run the analysis script:

```bash
python analyze_metrics.py
```

This will generate visualizations (boxplots, bar charts) and a summary CSV in the `analysis/output_dir`.

## Output

- **Enhanced Images**: Saved in the configured `output_dir`.
- **Metrics**: A `metrics.csv` file inside the `output_dir`.
- **Analysis**: Plots and summary tables in the `analysis_results` folder.
